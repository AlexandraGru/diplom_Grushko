"""Add 100 users with Russian phone numbers

Revision ID: dbf17d2f10c7
Revises: 04c701a89a47
Create Date: 2025-12-15 18:34:50.403993

"""
from typing import Sequence, Union
import uuid
import random

from alembic import op
import sqlalchemy as sa


# revision identifiers, used by Alembic.
revision: str = 'dbf17d2f10c7'
down_revision: Union[str, None] = '04c701a89a47'
branch_labels: Union[str, Sequence[str], None] = None
depends_on: Union[str, Sequence[str], None] = None

# Конкретные пользователи (50 мужчин + 50 женщин)
USERS = [
    # Мужские (50)
    ('Олябышев', 'Денис', 'Степанович'),
    ('Непочатых', 'Альберт', 'Евгеньевич'),
    ('Северный', 'Дмитрий', 'Янович'),
    ('Путин', 'Дмитрий', 'Романович'),
    ('Чекрыгин', 'Александр', 'Глебович'),
    ('Фещук', 'Ефим', 'Витальевич'),
    ('Письменюк', 'Валерий', 'Семенович'),
    ('Живоедов', 'Антон', 'Вячеславович'),
    ('Голядкин', 'Ярослав', 'Борисович'),
    ('Теблоев', 'Владимир', 'Павлович'),
    ('Бусько', 'Владимир', 'Борисович'),
    ('Сольский', 'Иван', 'Артемович'),
    ('Косырев', 'Артур', 'Геннадьевич'),
    ('Домашников', 'Тимофей', 'Эдуардович'),
    ('Вовкушевский', 'Ярослав', 'Эдуардович'),
    ('Балун', 'Ильдар', 'Кириллович'),
    ('Кухтин', 'Сергей', 'Алексеевич'),
    ('Трипалин', 'Василий', 'Филиппович'),
    ('Артюх', 'Артур', 'Ефимович'),
    ('Семенкин', 'Семен', 'Антонович'),
    ('Заблудовский', 'Роберт', 'Германович'),
    ('Малярчук', 'Степан', 'Янович'),
    ('Шеворошкин', 'Кирилл', 'Радикович'),
    ('Скибин', 'Никита', 'Яковлевич'),
    ('Сункуев', 'Анатолий', 'Денисович'),
    ('Сукристов', 'Никита', 'Ярославович'),
    ('Мороз', 'Ильдар', 'Романович'),
    ('Космачев', 'Марсель', 'Васильевич'),
    ('Чудновский', 'Денис', 'Янович'),
    ('Никоненко', 'Игорь', 'Павлович'),
    ('Великобородов', 'Артур', 'Александрович'),
    ('Хайдуров', 'Юрий', 'Альбертович'),
    ('Катигроб', 'Аркадий', 'Дмитриевич'),
    ('Овсяник', 'Семен', 'Валерьевич'),
    ('Архиповский', 'Михаил', 'Васильевич'),
    ('Ведихов', 'Филипп', 'Робертович'),
    ('Серик', 'Евгений', 'Николаевич'),
    ('Парманин', 'Иван', 'Яковлевич'),
    ('Шлячков', 'Григорий', 'Семенович'),
    ('Бобков', 'Павел', 'Антонович'),
    ('Сотников', 'Тимур', 'Русланович'),
    ('Ряшенцев', 'Федор', 'Русланович'),
    ('Гриценко', 'Станислав', 'Филиппович'),
    ('Окороков', 'Данил', 'Робертович'),
    ('Кривошеин', 'Данил', 'Константинович'),
    ('Первозванский', 'Константин', 'Дамирович'),
    ('Мацук', 'Владислав', 'Григорьевич'),
    ('Филимохин', 'Иван', 'Станиславович'),
    ('Глушкин', 'Ярослав', 'Дмитриевич'),
    ('Стеблов', 'Ярослав', 'Марселевич'),
    # Женские (50)
    ('Гимазетдинова', 'Наталья', 'Андреевна'),
    ('Никишова', 'Валерия', 'Дмитриевна'),
    ('Шабдарбаева', 'Алина', 'Леонидовна'),
    ('Мадина', 'Алена', 'Аркадьевна'),
    ('Алекминская', 'Юлия', 'Ильдаровна'),
    ('Багулина', 'Дарья', 'Олеговна'),
    ('Поклонская', 'Раиса', 'Витальевна'),
    ('Симунина', 'Юлия', 'Константиновна'),
    ('Юшенкова', 'Дарья', 'Вадимовна'),
    ('Садова', 'Евгения', 'Дамировна'),
    ('Ашанская', 'Елена', 'Германовна'),
    ('Татаренко', 'Раиса', 'Марселевна'),
    ('Пупенко', 'Вероника', 'Валерьевна'),
    ('Бегалина', 'Римма', 'Владиславовна'),
    ('Новохацкая', 'Олеся', 'Георгиевна'),
    ('Бирюзова', 'Алина', 'Даниловна'),
    ('Марковникова', 'Надежда', 'Николаевна'),
    ('Фалалеева', 'Лидия', 'Андреевна'),
    ('Чинаева', 'Анастасия', 'Семеновна'),
    ('Захватаева', 'Анастасия', 'Максимовна'),
    ('Патренина', 'Елена', 'Егоровна'),
    ('Костюченкова', 'Жанна', 'Рамилевна'),
    ('Девятинина', 'Анна', 'Владимировна'),
    ('Елохова', 'Любовь', 'Леонидовна'),
    ('Одинцова', 'Эльвира', 'Яновна'),
    ('Война', 'Алла', 'Эдуардовна'),
    ('Сидоренкова', 'Кристина', 'Вадимовна'),
    ('Неаполитанова', 'Антонина', 'Егоровна'),
    ('Устич', 'Ирина', 'Альбертовна'),
    ('Ермоленко', 'Ольга', 'Ильдаровна'),
    ('Кутуева', 'Юлия', 'Константиновна'),
    ('Костюшина', 'Валерия', 'Викторовна'),
    ('Садриева', 'Жанна', 'Маратовна'),
    ('Бахарева', 'Римма', 'Ильинична'),
    ('Полуектова', 'Елена', 'Леонидовна'),
    ('Азымова', 'Карина', 'Павловна'),
    ('Стукова', 'Альбина', 'Романовна'),
    ('Байбикова', 'Евгения', 'Денисовна'),
    ('Ефименко', 'Евгения', 'Даниловна'),
    ('Нургалиева', 'Евгения', 'Яковлевна'),
    ('Гадаева', 'Полина', 'Григорьевна'),
    ('Чухрова', 'Елена', 'Александровна'),
    ('Топорова', 'Олеся', 'Михайловна'),
    ('Макоева', 'Алина', 'Радиковна'),
    ('Маркцева', 'Людмила', 'Игоревна'),
    ('Чаусская', 'Александра', 'Петровна'),
    ('Автайкина', 'Валерия', 'Антоновна'),
    ('Вахонина', 'Анна', 'Вячеславовна'),
    ('Ощепкова', 'Анастасия', 'Олеговна'),
    ('Непорядьева', 'Валерия', 'Витальевна'),
]


def generate_phone_number() -> str:
    """Генерирует российский номер телефона +7XXXXXXXXXX"""
    operator_codes = ['900', '901', '902', '903', '904', '905', '906', '907', 
                      '908', '909', '910', '911', '912', '913', '914', '915',
                      '916', '917', '918', '919', '920', '921', '922', '923',
                      '924', '925', '926', '927', '928', '929', '930', '931',
                      '932', '933', '934', '936', '937', '938', '939', '950',
                      '951', '952', '953', '954', '955', '956', '957', '958',
                      '959', '960', '961', '962', '963', '964', '965', '966',
                      '967', '968', '969', '977', '978', '980', '981', '982',
                      '983', '984', '985', '986', '987', '988', '989', '991',
                      '992', '993', '994', '995', '996', '997', '999']
    code = random.choice(operator_codes)
    number = ''.join([str(random.randint(0, 9)) for _ in range(7)])
    return f'+7{code}{number}'


def generate_inn() -> str:
    """Генерирует ИНН (12 цифр для физических лиц)"""
    return ''.join([str(random.randint(0, 9)) for _ in range(12)])


def upgrade() -> None:
    users_data = []
    used_phones = set()
    used_inns = set()
    
    for surname, name, patronymic in USERS:
        # Генерируем уникальные телефон и ИНН
        while True:
            phone = generate_phone_number()
            if phone not in used_phones:
                used_phones.add(phone)
                break
        
        while True:
            inn = generate_inn()
            if inn not in used_inns:
                used_inns.add(inn)
                break
        
        users_data.append({
            'id': str(uuid.uuid4()),
            'surname': surname,
            'name': name,
            'patronymic': patronymic,
            'phone_number': phone,
            'inn': inn,
            'role': 'user'
        })
    
    connection = op.get_bind()
    
    for user in users_data:
        connection.execute(
            sa.text("""
                INSERT INTO users (id, surname, name, patronymic, phone_number, inn, role)
                VALUES (:id, :surname, :name, :patronymic, :phone_number, :inn, :role)
            """),
            {
                'id': user['id'],
                'surname': user['surname'],
                'name': user['name'],
                'patronymic': user['patronymic'],
                'phone_number': user['phone_number'],
                'inn': user['inn'],
                'role': user['role']
            }
        )
    
    connection.commit()


def downgrade() -> None:
    op.execute("DELETE FROM users WHERE phone_number LIKE '+7%'")
